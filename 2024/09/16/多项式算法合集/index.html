<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Mist","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="头函数 1234567891011#define poly vector&lt;int&gt;#define bg begin#define pb push_backconst int mod&#x3D;998244353,g&#x3D;3;inline int add(int a,int b)&#123;return a+b&gt;&#x3D;mod?a+b-mod:a+b;&#125;inline void Add(int">
<meta property="og:type" content="article">
<meta property="og:title" content="多项式算法合集">
<meta property="og:url" content="http://example.com/2024/09/16/%E5%A4%9A%E9%A1%B9%E5%BC%8F%E7%AE%97%E6%B3%95%E5%90%88%E9%9B%86/index.html">
<meta property="og:site_name" content="Stargazer&#39; blog">
<meta property="og:description" content="头函数 1234567891011#define poly vector&lt;int&gt;#define bg begin#define pb push_backconst int mod&#x3D;998244353,g&#x3D;3;inline int add(int a,int b)&#123;return a+b&gt;&#x3D;mod?a+b-mod:a+b;&#125;inline void Add(int">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20190709223754304.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyNTU1MDA5,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20190709223809208.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyNTU1MDA5,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200320183348900.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyNTU1MDA5,size_16,color_FFFFFF,t_70">
<meta property="article:published_time" content="2024-09-16T13:27:07.000Z">
<meta property="article:modified_time" content="2024-09-16T14:33:22.034Z">
<meta property="article:author" content="Yike Chen">
<meta property="article:tag" content="XCPC,Templates">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://img-blog.csdnimg.cn/20190709223754304.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyNTU1MDA5,size_16,color_FFFFFF,t_70">

<link rel="canonical" href="http://example.com/2024/09/16/%E5%A4%9A%E9%A1%B9%E5%BC%8F%E7%AE%97%E6%B3%95%E5%90%88%E9%9B%86/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>多项式算法合集 | Stargazer' blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Stargazer' blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/09/16/%E5%A4%9A%E9%A1%B9%E5%BC%8F%E7%AE%97%E6%B3%95%E5%90%88%E9%9B%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Yike Chen">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Stargazer' blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          多项式算法合集
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2024-09-16 21:27:07 / Modified: 22:33:22" itemprop="dateCreated datePublished" datetime="2024-09-16T21:27:07+08:00">2024-09-16</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>头函数</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> poly vector<span class="string">&lt;int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> bg begin</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> mod=<span class="number">998244353</span>,g=<span class="number">3</span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">add</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b)</span></span>&#123;<span class="keyword">return</span> a+b&gt;=mod?a+b-mod:a+b;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">Add</span><span class="params">(<span class="type">int</span> &amp;a,<span class="type">int</span> b)</span></span>&#123;a=<span class="built_in">add</span>(a,b);&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">dec</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b)</span></span>&#123;<span class="keyword">return</span> a&gt;=b?a-b:a-b+mod;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">Dec</span><span class="params">(<span class="type">int</span> &amp;a,<span class="type">int</span> b)</span></span>&#123;a=<span class="built_in">dec</span>(a,b);&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">mul</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b)</span></span>&#123;<span class="keyword">return</span> <span class="number">1ll</span>*a*b&gt;=mod?<span class="number">1ll</span>*a*b%mod:a*b;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">Mul</span><span class="params">(<span class="type">int</span> &amp;a,<span class="type">int</span> b)</span></span>&#123;a=<span class="built_in">mul</span>(a,b);&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">ksm</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b,<span class="type">int</span> res=<span class="number">1</span>)</span></span>&#123;<span class="keyword">for</span>(;b;b&gt;&gt;=<span class="number">1</span>,a=<span class="built_in">mul</span>(a,a))(b&amp;<span class="number">1</span>)&amp;&amp;(res=<span class="built_in">mul</span>(res,a));<span class="keyword">return</span> res;&#125;</span><br></pre></td></tr></table></figure>
<h3 id="多项式加减点乘点除"><a href="#多项式加减点乘点除" class="headerlink" title="多项式加减点乘点除"></a>多项式加减点乘点除</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">inline</span> poly <span class="keyword">operator</span> +(poly a,poly b)&#123;</span><br><span class="line">	poly c;<span class="type">int</span> lim=<span class="built_in">max</span>(a.<span class="built_in">size</span>(),b.<span class="built_in">size</span>());c.<span class="built_in">resize</span>(lim);</span><br><span class="line">	a.<span class="built_in">resize</span>(lim),b.<span class="built_in">resize</span>(lim);</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;lim;i++)c[i]=<span class="built_in">add</span>(a[i],b[i]);<span class="keyword">return</span> c;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">inline</span> poly <span class="keyword">operator</span> -(poly a,poly b)&#123;</span><br><span class="line">	poly c;<span class="type">int</span> lim=<span class="built_in">max</span>(a.<span class="built_in">size</span>(),b.<span class="built_in">size</span>());c.<span class="built_in">resize</span>(lim);</span><br><span class="line">	a.<span class="built_in">resize</span>(lim),b.<span class="built_in">resize</span>(lim);</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;lim;i++)c[i]=<span class="built_in">dec</span>(a[i],b[i]);<span class="keyword">return</span> c;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">inline</span> poly <span class="keyword">operator</span> *(poly a,<span class="type">int</span> b)&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;a.<span class="built_in">size</span>();i++)<span class="built_in">Mul</span>(a[i],b);<span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">inline</span> poly <span class="keyword">operator</span> /(poly a,<span class="type">int</span> b)&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>,inv=<span class="built_in">ksm</span>(b,mod<span class="number">-2</span>);i&lt;a.<span class="built_in">size</span>();i++)<span class="built_in">Mul</span>(a[i],inv);</span><br><span class="line">	<span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="多项式乘法"><a href="#多项式乘法" class="headerlink" title="多项式乘法"></a>多项式乘法</h3><h3 id="FFT："><a href="#FFT：" class="headerlink" title="FFT："></a>FFT：</h3><h4 id="前置"><a href="#前置" class="headerlink" title="前置"></a>前置</h4><p>多项式的点值和系数表示法：</p>
<p>对于一个 $  n $  次多项式 $  f(x) $<br> $  f(x)=a_0+a_1x+a_2x^2+a_3x^3……a_nx^n $  被称作该多项式的系数表示<br>我们可以通过带任意一个 $  x $  都可以的到唯一的一个 $  f(x) $<br>但 $  oi $  中一般 $  x $  一般都只是一个不定元，不会带入特定值计算，比如用作表示下标之类的</p>
<p>而如果我们把不同的 $  n+1 $  带入进去得到的 $  n+1 $  个点值叫做点值表示法<br>由 $  n+1 $  个点也可以还原出唯一一个 $  n $  次多项式</p>
<hr>
<p>虚数</p>
<p>即 $  i，\sqrt{-1} $<br>考虑在平面直角坐标系内<br>将 $  y $  轴用 $  i $  来表示</p>
<p>复数更准确的定义是</p>
<p> $  e^{ik}=\cos(k)+i\sin(k) $  </p>
<p>这样平面上一个点就是 $  (a,bi) $  的形式<br>而2个虚数相乘，就对应平面直角坐标系上2个向量模长相乘，极角相加</p>
<p>由于 $  C++ $  自带的复数很慢<br>所以我们一般手写复数结构体</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">double</span> pi=<span class="built_in">acos</span>(<span class="number">-1</span>);</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">complex</span>&#123;</span><br><span class="line">    <span class="type">double</span> x,y;</span><br><span class="line">    <span class="built_in">complex</span>(<span class="type">double</span> _x=<span class="number">0</span>,<span class="type">double</span> _y=<span class="number">0</span>):<span class="built_in">x</span>(_x),<span class="built_in">y</span>(_y)&#123;&#125;</span><br><span class="line">    <span class="keyword">friend</span> <span class="keyword">inline</span> complex <span class="keyword">operator</span> +(<span class="type">const</span> complex &amp;a,<span class="type">const</span> complex &amp;b)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">complex</span>(a.x+b.x,a.y+b.y);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">friend</span> <span class="keyword">inline</span> complex <span class="keyword">operator</span> -(<span class="type">const</span> complex &amp;a,<span class="type">const</span> complex &amp;b)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">complex</span>(a.x-b.x,a.y-b.y);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">friend</span> <span class="keyword">inline</span> complex <span class="keyword">operator</span> /(<span class="type">const</span> complex &amp;a,<span class="type">const</span> <span class="type">double</span> &amp;b)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">complex</span>(a.x/b,a.y/b);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">friend</span> <span class="keyword">inline</span> complex <span class="keyword">operator</span> *(<span class="type">const</span> complex &amp;a,<span class="type">const</span> complex &amp;b)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">complex</span>(a.x*b.x-a.y*b.y,a.x*b.y+a.y*b.x);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<hr>
<p>单位根</p>
<p> $  fft $  的根本<br> $  n $  次单位根指的是满足 $  w^n=1 $  的复数<br> $  n $  次单位根有 $  n $  个,分别表示为 $  w_{n}^{k}，k=0,1,2,……n-1 $<br>实际上对应的将平面单位圆周上的 $  n $  个点<br>这些点将单位圆周均分成 $  n $  块，且构成一个正 $  n $  边形</p>
<p>更准确的表示为 $  w_n^k=e^{2\pi ik/n} $<br>即 $  w_n^k=\cos(2\pi k/n)+i\sin(2\pi k/n) $  表示<br>即单位圆上的 $  n $  点</p>
<p>单位根几个重要的性质：</p>
<p><strong>1、消去引理</strong></p>
<p>对于任何整数 $  n\geq0,k\geq 0,d\geq 0 $<br>有 $  w_{dn}^{dk}=w_{n}^{k} $  </p>
<p>证明: $  w_{dn}^{dk}=e^{2\pi idk/dn}=e^{2\pi ik/n}=w_{n}^{k} $  </p>
<p><strong>2、折半引理</strong></p>
<p>如果 $  n\geq 0 $  且 $  n $  为偶数，那么<br>对所有 $  n $  次单位根平方，得到的集合是 $  n/2 $  个 $  n/2 $  次单位根的集合<br>说白了就是 $  w_{n}^{k+\frac n 2}=-w_n^{k} $  或者就是 $  w_n^{\frac n 2}=-1 $<br>证明：画个单位圆， $  \frac n 2 $  就是旋转了 $  180° $  ,自然取反</p>
<p><strong>3、求和引理</strong></p>
<p>对于任意整数 $  n\geq 1 $  和 $  n\not | k $<br>有 $  \sum_{j=0}^{n-1}(w_{n}^k)^j=0 $  </p>
<p>考虑这其实是一个等比数列， $  w_{n}^{k}\not= 1 $  时<br>原式 $  =\frac{(w_{n}^{k})^{n}-1}{w_{n}^{k}-1}=\frac{(w_{n}^n)^k-1}{w_{n}^{k}-1}=0 $  </p>
<p>而当 $  n|k $  时，原式显然为 $  n $  </p>
<p>这个性质在后面很重要</p>
<h4 id="算法"><a href="#算法" class="headerlink" title="算法"></a>算法</h4><p>考虑对于两个多项式<br> $  A(x)=a_0+a_1x+a_2x^2+a_3x^3……a_nx^n $<br> $  B(x)=b_0+b_1x+b_2x^2+b_3x^3……b_mx^m $<br>我们要求一个 $  n+m $  次多项式 $  C(x)=A(x)<em>B(x) $<br>更具体的 $  C(x) $  满足 $  c_i=\sum_{j=0}^{i}a_j</em>b_{i-j} $<br>也就是2个数列倒着乘的和，所谓的卷积</p>
<p>考虑如果我们直接拆开暴力做是 $  O(n^2) $  的<br>当然也有一种分治乘法可以做到 $  n^{log_23} $  (大概就是大常数 $  n\sqrt n $  )</p>
<p>而 $  FFT $  可以做到 $  O(nlogn) $  求出 $  C $  </p>
<hr>
<p>下面为了方便假设 $  n=m $  ， $  n\not  =m $  也没有区别</p>
<p>考虑如果我们有 $  n+1 $  个值 $  x_1,……，x_{n+1} $<br>如果已经求出 $  A(x_1)，……A(x_{n+1}) $<br>和 $  B(x_1),……B(x_{n+1}) $<br>也就是分别求出 $  x_1,……，x_n+1 $  的点值</p>
<p>那么我们可以直接在 $  O(n) $  的时间内求出<br> $  C(x_1)=A(x_1)<em>B(x_1)，……，C(x_{n+1})=A(x_{n+1})</em>B(x_{n+1}) $  </p>
<p>现在我们考虑这样</p>
<p>先对 $  A(x) $  , $  B(x) $  求出 $  n+1 $  个点的点值，乘起来得到 $  C(x) $  的点值<br>又对于一个 $  n $  次多项式，如果我们知道其 $  n+1 $  个不同点值<br>就一定可以还原出一个唯一的多项式<br>于是最后再由点值表示还原出原来的 $  C(x) $  </p>
<p>注意由于实际乘出来 $  C(x) $  最高系数是 $  2n-1 $<br>所以我们需要带入 $  2n $  个点求值<br>于是我们会将 $  A(x),B(x) $  补0到 $  2n $  次项<br>实际上由于 $  fft $  的特殊性<br><strong>我们会将项数补充到2的整数次幂次</strong></p>
<p>当然非二的整数次幂项的多项式乘法也是可以做的</p>
<p>第一步将系数转成点值是正变换，称作 $  DFT $  ,单次复杂度 $  O(nlogn) $<br>由点值还原系数为逆变换，称作 $  IDFT $  ,单次复杂度 $  O(nlogn) $<br>于是总复杂度就是 $  O(nlogn) $<br>整个操作被称为快速傅里叶变换 $  (FFT) $  </p>
<hr>
<p><strong>DFT：</strong></p>
<p>考虑我们带入 $  n $  次单位根 $  w_n $<br> $  A(w_n^k)=\sum_{i=0}^na_i(w_n^k)^i $<br>考虑将下标按照奇偶分类<br> $  A(w_n^k)=\sum_{i=0}^{\frac n 2-1}a_{2i}(w_n^{k})^{2i}+\sum_{i=0}^{\frac n2 -1}a_{2i+1}(w_{n}^k)^{2i+1} $  </p>
<p> $  =\sum_{i=0}^{\frac n 2-1}a_{2i}(w_n^{2ki})+w_{n}^k\sum_{i=0}^{\frac n2 -1}a_{2i+1}(w_{n}^{2ki}) $  </p>
<p> $  =\sum_{i=0}^{\frac n 2-1}a_{2i}(w_{\frac n 2}^{k})+w_n^k\sum_{i=0}^{\frac n2 -1}a_{2i+1}(w_{\frac n 2}^k) $  </p>
<p> $  =A_o(w_{\frac n 2}^k)+{w_{n}^k}A_1(w_{\frac n2 }^k) $  </p>
<p>这样 $  A_0 $  和 $  A_1 $  都只有 $  \frac n2 $  项了<br>可以继续递归去做<br>尽管现在复杂度并没有变化</p>
<p>考虑对于 $  A(w_n^{k+\frac n 2}) $<br> $  A(w_n^{k+\frac n 2})=\sum_{i=0}^{\frac n 2-1}a_{2i}(w_n^{k+\frac n 2})^{2i}+w_{n}^{k+\frac n 2}\sum_{i=0}^{\frac n2 -1}a_{2i+1}(w_{n}^{k+\frac n2 })^{2i} $  </p>
<p>考虑单位根的消去引理</p>
<p> $  w_{n}^{k+\frac n 2}=-w_n^k $  </p>
<p>则 $  A(w_n^{k+\frac n 2})=\sum_{i=0}^{\frac n 2-1}a_{2i}(-w_n^k)^{2i}+(-w_n^k)\sum_{i=0}^{\frac n2 -1}a_{2i+1}(-w_n^k)^{2i} $  </p>
<p> $  =\sum_{i=0}^{\frac n 2-1}a_{2i}(w_n^k)^{2i}-w_n^k\sum_{i=0}^{\frac n2 -1}a_{2i+1}(w_n^k)^{2i} $  </p>
<p> $  =\sum_{i=0}^{\frac n 2-1}a_{2i}(w_{\frac n 2}^{k})-w_n^k\sum_{i=0}^{\frac n2 -1}a_{2i+1}(w_{\frac n 2}^k) $  </p>
<p> $  =A_o(w_{\frac n 2}^k)-{w_{n}^k}A_1(w_{\frac n2 }^k) $  </p>
<p>我们发现唯一不同的就是第二项的符号<br>也就是说如果我们知道 $  A_o(w_{\frac n 2}^k) $  和 $  A_1(w_{\frac n2 }^k) $<br>我们就可以同时知道 $  A(w_n^{k+\frac n 2}) $  和 $  A(w_n^k) $  </p>
<p>考虑对于 $  k\in[0,n-1], $  我们求 $  A(w_n^k) $<br>就只需要知道 $  k\in[0,\frac n2-1 ],A_0(w_{\frac n2 }^k) $  和 $  A_1(w_{\frac n 2}^k) $<br>就可以在 $  O(n) $  的时间内得到 $  A $  </p>
<p>而 $  A_0 $  , $  A_1 $  系数都只有 $  \frac n 2 $  个，所以规模只有原来的一般<br>递归求解即可</p>
<p>时间复杂度 $  T(n)=2*T(\frac n2 )+O(n)=O(nlogn) $  </p>
<p>这里也是之所以要把项数补充到 $  2^k $<br>因为每一次都把 $  n $  项分成 $  \frac n 2 $  项<br>如果 $  n $  是奇数，那就没法分开了</p>
<p>由于递归常数比较大，而一般 $  fft $  有关的题时间瓶颈就在 $  DFT $  上面<br> $  DFT $   常数也很大<br>写的差的 $  fft $  甚至可以跑 $  1e6 $  的数据 $  T $  掉</p>
<p>所以我们考虑迭代做<br>由于每个数最终在的位置和原来不一样<br>所以我们要预处理出最终的位置上<br>代码如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> rev[N&lt;&lt;<span class="number">2</span>];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> lim)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;lim;i++)rev[i]=(rev[i&gt;&gt;<span class="number">1</span>]&gt;&gt;<span class="number">1</span>)|((i&amp;<span class="number">1</span>)*(lim&gt;&gt;<span class="number">1</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我们先把每个数放到最终应该在的地方然后一步步迭代回去就是了</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">DFT</span><span class="params">(complex f[],<span class="type">int</span> lim)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;lim;i++)<span class="keyword">if</span>(rev[i]&gt;i)<span class="built_in">swap</span>(f[i],f[rev[i]]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> mid=<span class="number">1</span>;mid&lt;lim;mid&lt;&lt;=<span class="number">1</span>)&#123;</span><br><span class="line">        complex now=<span class="built_in">plx</span>(<span class="built_in">cos</span>(pi/mid),<span class="built_in">sin</span>(pi/mid));</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;lim;i+=(mid&lt;&lt;<span class="number">1</span>))&#123;</span><br><span class="line">            complex w=<span class="built_in">plx</span>(<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;mid;j++,w=w*now)&#123;</span><br><span class="line">                plx p0=f[i+j],p1=w*f[i+j+mid];</span><br><span class="line">                f[i+j]=p0+p1,f[i+j+mid]=p0-p1;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<p><strong>IDFT：</strong></p>
<blockquote>
<p>以下摘抄自<a target="_blank" rel="noopener" href="http://blog.miskcoo.com/2015/04/polynomial-multiplication-and-fast-fourier-transform"> $  miskcoo $  </a></p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/20190709223754304.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyNTU1MDA5,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20190709223809208.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyNTU1MDA5,size_16,color_FFFFFF,t_70" alt="I是对角矩阵，即对角线上都是1，其他都是0"></p>
<hr>
<h4 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">double</span> pi=<span class="built_in">acos</span>(<span class="number">-1</span>);</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">plx</span>&#123;</span><br><span class="line">    <span class="type">double</span> x,y;</span><br><span class="line">    <span class="built_in">plx</span>(<span class="type">double</span> _x=<span class="number">0</span>,<span class="type">double</span> _y=<span class="number">0</span>):<span class="built_in">x</span>(_x),<span class="built_in">y</span>(_y)&#123;&#125;</span><br><span class="line">    <span class="keyword">friend</span> <span class="keyword">inline</span> plx <span class="keyword">operator</span> +(<span class="type">const</span> plx &amp;a,<span class="type">const</span> plx &amp;b)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">plx</span>(a.x+b.x,a.y+b.y);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">friend</span> <span class="keyword">inline</span> plx <span class="keyword">operator</span> -(<span class="type">const</span> plx &amp;a,<span class="type">const</span> plx &amp;b)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">plx</span>(a.x-b.x,a.y-b.y);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">friend</span> <span class="keyword">inline</span> plx <span class="keyword">operator</span> /(<span class="type">const</span> plx &amp;a,<span class="type">const</span> <span class="type">double</span> &amp;b)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">plx</span>(a.x/b,a.y/b);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">friend</span> <span class="keyword">inline</span> plx <span class="keyword">operator</span> *(<span class="type">const</span> plx &amp;a,<span class="type">const</span> plx &amp;b)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">plx</span>(a.x*b.x-a.y*b.y,a.x*b.y+a.y*b.x);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">fft</span><span class="params">(plx f[],<span class="type">int</span> lim,<span class="type">int</span> kd)</span></span>&#123;<span class="comment">//kd表示在做正变换还是逆变换</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;lim;i++)<span class="keyword">if</span>(rev[i]&gt;i)<span class="built_in">swap</span>(f[i],f[rev[i]]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> mid=<span class="number">1</span>;mid&lt;lim;mid&lt;&lt;=<span class="number">1</span>)&#123;</span><br><span class="line">        plx now=<span class="built_in">plx</span>(<span class="built_in">cos</span>(pi/mid),kd*<span class="built_in">sin</span>(pi/mid));</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;lim;i+=(mid&lt;&lt;<span class="number">1</span>))&#123;</span><br><span class="line">            plx w=<span class="built_in">plx</span>(<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;mid;j++,w=w*now)&#123;</span><br><span class="line">                plx p0=f[i+j],p1=w*f[i+j+mid];</span><br><span class="line">                f[i+j]=p0+p1,f[i+j+mid]=p0-p1;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(kd==<span class="number">-1</span>)<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;lim;i++)f[i]=f[i]/lim;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="NTT："><a href="#NTT：" class="headerlink" title="NTT："></a>NTT：</h3><p>由于 $  fft $  涉及复数和实数运算，实际会出现精度误差<br>在整数运算时难免会出锅</p>
<p>所以我们考虑一个能在模意义下的变换<br>这就是 $  ntt $  </p>
<p>首先引入原根的概念</p>
<p>对于一个素数 $  p $  ，其原根 $  g $  定义为满足 $  g^0,g^1,……，g^{p-2} $  互不相同的数<br>又由于费马定理，对一个素数 $  p $  ,有 $  a^{p-1}\equiv 1(mod\ p) $<br>这个和单位根很相似</p>
<p>我们考虑单位根之所以能够做 $  fft $  ，是因为 $  w $  的三个性质<br>考虑如果我们对于一个素数 $  p=2^n*k+1 $  ,我们令 $  g_n=g^k $<br>这样我们就可以满足 $  g_n^0,g_n^1,g_n^2……g_n^{n-1} $  互不相同且满足这些性质（不想证了）</p>
<p>但这也就限制了 $  ntt $  的模数必须是 $  k*2^n+1 $  的形式<br>否则就要做任意模数 $  ntt $<br>做法就是选出几个模数分别做之后 $  Crt $  合并答案（并不会）<br>代码和 $  fft $  类似<br>由于 $  w_n^{-k}=w_n^{n-k} $<br>所以我们可以先做的时候不管正逆变换<br>最后把 $  1 $  ~ $  n-1 $  反转一下就可以了</p>
<h4 id="代码实现-1"><a href="#代码实现-1" class="headerlink" title="代码实现"></a>代码实现</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">ntt</span><span class="params">(poly &amp;f,<span class="type">int</span> lim,<span class="type">int</span> kd)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;lim;i++)<span class="keyword">if</span>(i&lt;rev[i])<span class="built_in">swap</span>(f[i],f[rev[i]]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> mid=<span class="number">1</span>;mid&lt;lim;mid&lt;&lt;=<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="type">int</span> now=<span class="built_in">ksm</span>(g,(mod<span class="number">-1</span>)/(mid&lt;&lt;<span class="number">1</span>));</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;lim;i+=(mid&lt;&lt;<span class="number">1</span>))&#123;</span><br><span class="line">            <span class="type">int</span> w=<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;mid;j++,w=<span class="built_in">mul</span>(w,now))&#123;</span><br><span class="line">                <span class="type">int</span> a0=f[i+j],a1=<span class="built_in">mul</span>(w,f[i+j+mid]);</span><br><span class="line">                f[i+j]=<span class="built_in">add</span>(a0,a1),f[i+j+mid]=<span class="built_in">dec</span>(a0,a1);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(kd==<span class="number">-1</span>&amp;&amp;(<span class="built_in">reverse</span>(f.<span class="built_in">bg</span>()<span class="number">+1</span>,f.<span class="built_in">bg</span>()+lim),<span class="number">1</span>))<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>,inv=<span class="built_in">ksm</span>(lim,mod<span class="number">-2</span>);i&lt;lim;i++)f[i]=<span class="built_in">mul</span>(f[i],inv);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>由于 $  ntt $  中每次乘起来很耗费时间</p>
<p>于是我们可以预处理出原根优化常数</p>
<p>预处理原根</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1000005</span>,C=<span class="number">21</span>;</span><br><span class="line"><span class="type">int</span> *w[<span class="number">22</span>];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">init_w</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=C;i++)</span><br><span class="line">	w[i]=<span class="keyword">new</span> <span class="type">int</span>[<span class="number">1</span>&lt;&lt;(i<span class="number">-1</span>)];</span><br><span class="line">	<span class="type">int</span> wn=<span class="built_in">ksm</span>(g,(mod<span class="number">-1</span>)/(<span class="number">1</span>&lt;&lt;C));</span><br><span class="line">	w[C][<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;(<span class="number">1</span>&lt;&lt;(C<span class="number">-1</span>));i++)w[C][i]=<span class="built_in">mul</span>(w[C][i<span class="number">-1</span>],wn);</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=C<span class="number">-1</span>;i;i--)</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;(<span class="number">1</span>&lt;&lt;(i<span class="number">-1</span>));j++)</span><br><span class="line">	w[i][j]=w[i<span class="number">+1</span>][j&lt;&lt;<span class="number">1</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>速度比不预处理快了差不多 $  25\% $  到 $  45\% $  不等</p>
<p>其实 $  ntt $  本身常数不算很大，运算常数大概也只有5、6左右<br>不过下标不连续可能会导致慢一些</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">ntt</span><span class="params">(poly &amp;f,<span class="type">int</span> lim,<span class="type">int</span> kd)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;lim;i++)<span class="keyword">if</span>(i&gt;rev[i])<span class="built_in">swap</span>(f[i],f[rev[i]]);</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> mid=<span class="number">1</span>,l=<span class="number">1</span>;mid&lt;lim;mid&lt;&lt;=<span class="number">1</span>,l++)</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;lim;i+=(mid&lt;&lt;<span class="number">1</span>))</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>,a0,a1;j&lt;mid;j++)</span><br><span class="line">			a0=f[i+j],a1=<span class="built_in">mul</span>(f[i+j+mid],w[l][j]),</span><br><span class="line">			f[i+j]=<span class="built_in">add</span>(a0,a1),f[i+j+mid]=<span class="built_in">dec</span>(a0,a1);</span><br><span class="line">	<span class="keyword">if</span>(kd==<span class="number">-1</span>&amp;&amp;(<span class="built_in">reverse</span>(f.<span class="built_in">begin</span>()<span class="number">+1</span>,f.<span class="built_in">begin</span>()+lim),<span class="number">1</span>))</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> inv=<span class="built_in">ksm</span>(lim,mod<span class="number">-2</span>),i=<span class="number">0</span>;i&lt;lim;i++)<span class="built_in">Mul</span>(f[i],inv);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>乘法</p>
<p>可以在比较小的时候暴力加循环展开</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">inline</span> poly <span class="keyword">operator</span> *(poly a,poly b)&#123;</span><br><span class="line">	<span class="type">int</span> deg=a.<span class="built_in">size</span>()+b.<span class="built_in">size</span>()<span class="number">-1</span>,lim=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">if</span>(deg&lt;=<span class="number">128</span>)&#123;</span><br><span class="line">		<span class="function">poly <span class="title">c</span><span class="params">(deg,<span class="number">0</span>)</span></span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;a.<span class="built_in">size</span>();i++)</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;b.<span class="built_in">size</span>();j++)</span><br><span class="line">			<span class="built_in">Add</span>(c[i+j],<span class="built_in">mul</span>(a[i],b[j]));</span><br><span class="line">		<span class="keyword">return</span> c;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">while</span>(lim&lt;deg)lim&lt;&lt;=<span class="number">1</span>;<span class="built_in">init</span>(lim);</span><br><span class="line">	a.<span class="built_in">resize</span>(lim),<span class="built_in">ntt</span>(a,lim,<span class="number">1</span>);</span><br><span class="line">	b.<span class="built_in">resize</span>(lim),<span class="built_in">ntt</span>(b,lim,<span class="number">1</span>);</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;lim;i++)<span class="built_in">Mul</span>(a[i],b[i]);</span><br><span class="line">	<span class="built_in">ntt</span>(a,lim,<span class="number">-1</span>),a.<span class="built_in">resize</span>(deg);</span><br><span class="line">	<span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="多项式求逆："><a href="#多项式求逆：" class="headerlink" title="多项式求逆："></a>多项式求逆：</h3><p>已知一个 $  n-1 $  次多项式 $  A(x) $  ，求多项式 $  B(x) $  满足：</p>
<script type="math/tex; mode=display">A(x)B(x)\equiv 1(mod\ x^n)</script><h4 id="求解过程"><a href="#求解过程" class="headerlink" title="求解过程"></a>求解过程</h4><p>倍增：</p>
<p>若已知 <script type="math/tex">A(x)B(x)'\equiv 1(mod \ x^{\lceil \frac n 2\rceil})</script>  </p>
<script type="math/tex; mode=display">A(x)B(x)'-A(x)B(x)\equiv 0(mod \ x^{\lceil \frac n 2\rceil})</script><script type="math/tex; mode=display">B(x)'-B(x)\equiv 0(mod \ x^{\lceil \frac n 2\rceil})</script><p>平方：</p>
<script type="math/tex; mode=display">B(x)'^2+B(x)^2-2B(x)'B(x)\equiv 0(mod \ x^{ n})</script><script type="math/tex; mode=display">A(x)(B(x)'^2+B(x)^2-2B(x)'B(x))\equiv 0(mod \ x^{ n})</script><script type="math/tex; mode=display">B(x)\equiv 2B(x)'-A(x)B(x)'^2(mod\ x^n)</script><p>复杂度 $  T(n)=T(\frac n 2)+O(nlogn)=O(nlogn) $  </p>
<p>注意次数，最高到3倍，开的4倍</p>
<h4 id="代码实现-2"><a href="#代码实现-2" class="headerlink" title="代码实现"></a>代码实现</h4><h2 id=""><a href="#" class="headerlink" title=""></a><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> poly <span class="title">Inv</span><span class="params">(poly a,<span class="type">int</span> deg)</span></span>&#123;</span><br><span class="line">	poly c,<span class="built_in">b</span>(<span class="number">1</span>,<span class="built_in">ksm</span>(a[<span class="number">0</span>],mod<span class="number">-2</span>));</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> lim=<span class="number">4</span>;lim&lt;(deg&lt;&lt;<span class="number">2</span>);lim&lt;&lt;=<span class="number">1</span>)&#123;</span><br><span class="line">		<span class="built_in">init</span>(lim);</span><br><span class="line">		c=a,c.<span class="built_in">resize</span>(lim&gt;&gt;<span class="number">1</span>);</span><br><span class="line">		c.<span class="built_in">resize</span>(lim),<span class="built_in">ntt</span>(c,lim,<span class="number">1</span>);</span><br><span class="line">		b.<span class="built_in">resize</span>(lim),<span class="built_in">ntt</span>(b,lim,<span class="number">1</span>);</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;lim;i++)<span class="built_in">Mul</span>(b[i],<span class="built_in">dec</span>(<span class="number">2</span>,<span class="built_in">mul</span>(b[i],c[i])));</span><br><span class="line">		<span class="built_in">ntt</span>(b,lim,<span class="number">-1</span>),b.<span class="built_in">resize</span>(lim&gt;&gt;<span class="number">1</span>);</span><br><span class="line">	&#125;b.<span class="built_in">resize</span>(deg);<span class="keyword">return</span> b;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></h2><h3 id="多项式开方："><a href="#多项式开方：" class="headerlink" title="多项式开方："></a>多项式开方：</h3><p>已知一个 $  n-1 $  次多项式 $  A(x) $  ,求一个 $  mod\ x^n $  意义下的多项式 $  B(x) $  满足</p>
<script type="math/tex; mode=display">B(x)^2\equiv A(x)(mod\ x^n)</script><p>满足 $  A[0]=1 $  </p>
<h4 id="求解过程-1"><a href="#求解过程-1" class="headerlink" title="求解过程"></a>求解过程</h4><p>倍增</p>
<p>首先当 $  n=1 $  时要满足 $  A[0]=1 $  （否则要二次剩余解） </p>
<p>假设已知 <script type="math/tex">B(x)'^2\equiv A(x)(mod\ x^{\lceil \frac n 2\rceil})</script><br>由于 $  \lceil\frac n 2\rceil $  以上的项是不会有影响的<br>所以 <script type="math/tex">B(x)'\equiv B(x) (mod\ x^{\lceil \frac n 2\rceil})</script><br>移项平方得：</p>
<script type="math/tex; mode=display">B(x)^2+B(x)'^2-2B(x)B(x)'\equiv 0(mod \ x^n)</script><script type="math/tex; mode=display">A(x)+B(x)'^2\equiv 2B(x)B(x)'(mod \  x^n)</script><script type="math/tex; mode=display">B(x)\equiv \frac{A(x)}{2B(x)'}+\frac{B(x)}{2}(mod\ x^n)</script><p>复杂度 $  T(n)=T(\frac n 2)+O(nlogn)=O(nlogn) $  </p>
<h4 id="代码实现-3"><a href="#代码实现-3" class="headerlink" title="代码实现"></a>代码实现</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> poly <span class="title">Sqrt</span><span class="params">(poly a,<span class="type">int</span> deg)</span></span>&#123;</span><br><span class="line">	<span class="function">poly <span class="title">b</span><span class="params">(<span class="number">1</span>,<span class="number">1</span>)</span>,c,d</span>;<span class="type">int</span> inv2=<span class="built_in">ksm</span>(<span class="number">2</span>,mod<span class="number">-2</span>);</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> lim=<span class="number">4</span>;lim&lt;(deg&lt;&lt;<span class="number">2</span>);lim&lt;&lt;=<span class="number">1</span>)&#123;</span><br><span class="line">		c=a,c.<span class="built_in">resize</span>(lim&gt;&gt;<span class="number">1</span>);</span><br><span class="line">		<span class="built_in">init_rev</span>(lim),d=<span class="built_in">Inv</span>(b,lim&gt;&gt;<span class="number">1</span>),</span><br><span class="line">		c=c*d,b.<span class="built_in">resize</span>(lim);</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;lim;i++)b[i]=<span class="built_in">mul</span>(inv2,<span class="built_in">add</span>(b[i],c[i]));</span><br><span class="line">	&#125;b.<span class="built_in">resize</span>(deg);<span class="keyword">return</span> b;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="多项式除法和取模："><a href="#多项式除法和取模：" class="headerlink" title="多项式除法和取模："></a>多项式除法和取模：</h3><p>给定一个 $  n $  次多项式 $  A(x) $  和一个 $  m $  次多项式 $  B(x) $<br>求一个 $  n-m $  次多项式 $  C(x) $  和 $  m-1 $  次多项式 $  D(x) $  满足：</p>
<script type="math/tex; mode=display">A(x)=B(x)C(x)+D(x)</script><h4 id="求解过程-2"><a href="#求解过程-2" class="headerlink" title="求解过程"></a>求解过程</h4><p>考虑对一个最高次数为 $  n $  的多项式 $  B(x) $  操作 $  B^R(x)=x^nB(\frac 1 x) $<br>会发现 $  B^R(x) $  只是 $  B(x) $  的系数反转的柿子</p>
<p>考虑 <script type="math/tex">A(x)= B(x)C(x)+D(x)</script><br> $  A(x) $  最高项为 $  n $  , $  B(x) $  最高项为 $  m $  ,则 $  C(x) $  最高项为 $  n-m $  , $  D(x) $  为 $  m-1 $<br>两边同时乘一个 $  x^n $  ,并带入 $  \frac 1 x $  </p>
<script type="math/tex; mode=display">x^nA(x)= x^mB(x)x^{n-m}C(x)+x^{n-m+1}*x^{m-1}D(x)</script><script type="math/tex; mode=display">A^R(x)=B^R(x)C^R(x)+x^{n-m+1}D^R(x)</script><p>考虑在 $  mod\ x^{n-m+1} $  意义下， $  A,B $  已知， $  C $  最高为 $  n-m $  不影响，而 $  D $  被消去<br>则 <script type="math/tex">A^R(x)\equiv B^R(x)C^R(x)(mod\ x^{n-m+1})</script>  </p>
<p>多项式求逆就可以了</p>
<p>复杂度 $  O(nlogn) $  </p>
<h4 id="代码实现-4"><a href="#代码实现-4" class="headerlink" title="代码实现"></a>代码实现</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">inline</span> poly <span class="keyword">operator</span> /(poly a,poly b)&#123;</span><br><span class="line">	<span class="type">int</span> lim=<span class="number">1</span>,deg=a.<span class="built_in">size</span>()-b.<span class="built_in">size</span>()<span class="number">+1</span>;</span><br><span class="line">	<span class="built_in">reverse</span>(a.<span class="built_in">bg</span>(),a.<span class="built_in">end</span>());</span><br><span class="line">	<span class="built_in">reverse</span>(b.<span class="built_in">bg</span>(),b.<span class="built_in">end</span>());</span><br><span class="line">	<span class="keyword">while</span>(lim&lt;=deg)lim&lt;&lt;=<span class="number">1</span>;</span><br><span class="line">	b=<span class="built_in">Inv</span>(b,lim),b.<span class="built_in">resize</span>(deg);</span><br><span class="line">	a=a*b,a.<span class="built_in">resize</span>(deg);</span><br><span class="line">	<span class="built_in">reverse</span>(a.<span class="built_in">bg</span>(),a.<span class="built_in">end</span>());</span><br><span class="line">	<span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">inline</span> poly <span class="keyword">operator</span> %(poly a,poly b)&#123;</span><br><span class="line">	poly c=a-(a/b)*b;</span><br><span class="line">	c.<span class="built_in">resize</span>(b.<span class="built_in">size</span>()<span class="number">-1</span>);</span><br><span class="line">	<span class="keyword">return</span> c;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="多项式求导与积分"><a href="#多项式求导与积分" class="headerlink" title="多项式求导与积分"></a>多项式求导与积分</h3><p>复杂度 $  O(n) $  </p>
<h4 id="代码实现-5"><a href="#代码实现-5" class="headerlink" title="代码实现"></a>代码实现</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> poly <span class="title">deriv</span><span class="params">(poly a)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;a.<span class="built_in">size</span>()<span class="number">-1</span>;i++)a[i]=<span class="built_in">mul</span>(a[i<span class="number">+1</span>],i<span class="number">+1</span>);</span><br><span class="line">	a.<span class="built_in">pob</span>();<span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> poly <span class="title">integ</span><span class="params">(poly a)</span></span>&#123;</span><br><span class="line">	a.<span class="built_in">pb</span>(<span class="number">0</span>);</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=a.<span class="built_in">size</span>()<span class="number">-1</span>;i;i--)a[i]=<span class="built_in">mul</span>(a[i<span class="number">-1</span>],inv[i]);</span><br><span class="line">	a[<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="多项式Ln"><a href="#多项式Ln" class="headerlink" title="多项式Ln"></a>多项式Ln</h3><p>已知一个 $  n-1 $  次多项式 $  g(x) $  ,求一个 $  mod\ x^n $  意义下的多项式 $  f(x) $  ，满足：</p>
<script type="math/tex; mode=display">f(x)\equiv Ln(g(x))(mod\ x^n)</script><h4 id="求解过程-3"><a href="#求解过程-3" class="headerlink" title="求解过程"></a>求解过程</h4><p>若 <script type="math/tex">f(x)=ln(g(x))</script><br>则 <script type="math/tex">g'(x)=f'(x)g(x)</script>  </p>
<script type="math/tex; mode=display">f'(x)=\frac{g'(x)}{g(x)}</script><p>且要满足 $  g[0]=1 $<br>求导求逆最后再积分就可以了</p>
<p>复杂度 $  O(nlogn) $  </p>
<h4 id="代码实现-6"><a href="#代码实现-6" class="headerlink" title="代码实现"></a>代码实现</h4><h2 id="-1"><a href="#-1" class="headerlink" title=""></a><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">if f(x)=Ln(g(x))</span></span><br><span class="line"><span class="comment">then g&#x27;(x)=f&#x27;(x)g(x)</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> poly <span class="title">Ln</span><span class="params">(poly a,<span class="type">int</span> lim)</span></span>&#123;</span><br><span class="line">	a=<span class="built_in">integ</span>(<span class="built_in">deriv</span>(a)*<span class="built_in">Inv</span>(a,lim)),a.<span class="built_in">resize</span>(lim);</span><br><span class="line">	<span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></h2><h3 id="多项式Exp"><a href="#多项式Exp" class="headerlink" title="多项式Exp"></a>多项式Exp</h3><h4 id="前置知识"><a href="#前置知识" class="headerlink" title="前置知识"></a>前置知识</h4><p><a target="_blank" rel="noopener" href="https://www.zhihu.com/question/25627482">泰勒展开</a><br><a target="_blank" rel="noopener" href="http://blog.miskcoo.com/2015/06/polynomial-with-newton-method">牛顿迭代</a></p>
<h5 id="泰勒展开"><a href="#泰勒展开" class="headerlink" title="泰勒展开"></a>泰勒展开</h5><script type="math/tex; mode=display">f(x)=f(x_0)+\frac{f^1{(x_0)}}{1!}(x-x_0)+\frac{f^2(x_0)}{2!}(x-x_0)^2+……+\frac{f^n(x_0)}{n!}(x-x_0)^n+……</script><p>考虑我们要构造一个函数 $  g(x) $  使 $  g(x) $  完全拟合 $  f(x) $<br>那首先初始点 $  x_0 $  的值要和 $  f(x_0) $  一样<br>在此基础上只需要保证一阶导数，二阶导数……都完全相同即可<br>即 $  \forall i,f^i(x)=g^i(x) $<br>由于求 $  g $  第 $  i $  阶导数时为 $  i!a_i=f^i(x) $<br>即 $  a_i=\frac{f^i(x)}{i!} $<br>所以得证</p>
<h5 id="牛顿迭代"><a href="#牛顿迭代" class="headerlink" title="牛顿迭代"></a>牛顿迭代</h5><p>在多项式中一般用来解这类问题：</p>
<p>假设有函数 $  f $  和一个多项式 $  g(x)mod\ x^n $<br>满足 $  f(g(x))\equiv 0 ( mod\ x^n) $<br>已知 $  f $  ，求 $  g $  </p>
<p>说白了就是用来解 $  f(g(x))\equiv 0(mod\ x^n) $  之类的方程</p>
<p>首先在 $  n=1 $  的时候即常数时单独求</p>
<p>假设已经知道 $  f(g’(x))\equiv 0(mod\ x^{\lceil \frac n2 \rceil}) $<br>要求 $  f(g(x))\equiv0(mod \ x^n) $  </p>
<p>考虑将 $  f(g(x)) $  在 $  g’(x) $  处泰勒展开</p>
<script type="math/tex; mode=display">f(g(x))=f(g'(x))+\frac{f^1(g'(x))}{1!}(g(x)-g'(x))+\frac{f^2(g'(x))}{2!}(g(x)-g(x)')^2+……</script><p>首先显然有 $  g(x)\equiv g’(x)(mod \ x^{\lceil \frac n 2 \rceil}) $<br>所以 $  g(x)-g’(x) $  最低项次数一定大于 $  \lceil \frac n 2\rceil $  </p>
<p>则在 $  mod \ x^n $  意义下，整个式子从 $  (g(x)-g(x)’)^2 $  开始都为 $  0 $  了<br>则 <script type="math/tex">f(g(x))\equiv f(g'(x))+{f^1(g'(x))}(g(x)-g'(x))(mod\ x^n)</script>  </p>
<p>又 $  f(g(x))\equiv 0 (mod\ x^n) $  </p>
<script type="math/tex; mode=display">g(x)\equiv g'(x)-\frac{f(g'(x))}{f^1(g'(x))}(mod\ x^n)</script><p>这就大功告成了</p>
<p><strong>例：</strong></p>
<p>比如多项式开根<br>就是解 $  B(x)^2-A(x)\equiv 0(mod\ x^n) $<br>假设已知 $  B’(x)^2-A(x)\equiv 0(mod\ x^{\lceil \frac n 2\rceil}) $<br>这时候 $  f(B(x))=B(x)^2-A(x), $  则 $  f^1(B(x))=2B(x) $<br>带入 $  B(x)\equiv B’(x)-\frac{B’(x)^2-A(x)}{2B’(x)}\equiv \frac{B’(x)^2+A(x)}{2B’(x)} $<br>就是我们推出来的式子</p>
<hr>
<p>已知一个 $  n-1 $  次多项式 $  g(x) $  ,求一个 $  mod\ x^n $  意义下的多项式 $  f(x) $  ，满足：</p>
<script type="math/tex; mode=display">f(x)\equiv e^{g(x)}(mod\ x^n)</script><p>也就是 <script type="math/tex">Ln(f(x))\equiv g(x)(mod\ x^n)</script>  </p>
<h4 id="求解过程-4"><a href="#求解过程-4" class="headerlink" title="求解过程"></a>求解过程</h4><p>倍增：</p>
<p>考虑原问题，即求解方程 <script type="math/tex">Ln(f(x))-g(x)\equiv 0(mod\ x^n)</script>  </p>
<p>同样假设已经知道 $  Ln(f’(x))-g(x)\equiv 0(mod\ x^{\lceil \frac n 2\rceil}) $  </p>
<p>令 $  P(f(x))=Ln(f(x))-g(x) $  ,则 $  P^1(f(x))=\frac 1 {f(x)} $  </p>
<p>则 <script type="math/tex">f(x)\equiv f'(x)-\frac{Ln(f'(x))-g(x)}{\frac{1}{f'(x)}}\equiv f'(x)-f'(x)Ln(f'(x))+f'(x)g(x)</script>  </p>
<script type="math/tex; mode=display">\equiv f'(x)(1-Ln(f'(x))+g(x)) (mod\ x^n)</script><p>复杂度 $  T(n)=T(\frac n 2)+O(nlogn)=O(nlogn) $  </p>
<h4 id="代码实现-7"><a href="#代码实现-7" class="headerlink" title="代码实现"></a>代码实现</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> poly <span class="title">exp</span><span class="params">(poly a,<span class="type">int</span> deg)</span></span>&#123;</span><br><span class="line">	<span class="function">poly <span class="title">b</span><span class="params">(<span class="number">1</span>,<span class="number">1</span>)</span>,c</span>;<span class="type">int</span> n=a.<span class="built_in">size</span>();</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> lim=<span class="number">2</span>;lim&lt;(deg&lt;&lt;<span class="number">1</span>);lim&lt;&lt;=<span class="number">1</span>)&#123;</span><br><span class="line">		c=<span class="built_in">Ln</span>(b,lim);</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;lim;i++)c[i]=<span class="built_in">dec</span>(i&lt;n?a[i]:<span class="number">0</span>,c[i]);</span><br><span class="line">		<span class="built_in">Add</span>(c[<span class="number">0</span>],<span class="number">1</span>),b=b*c;</span><br><span class="line">		b.<span class="built_in">resize</span>(lim);</span><br><span class="line">	&#125;b.<span class="built_in">resize</span>(deg);<span class="keyword">return</span> b;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Euler-变换"><a href="#Euler-变换" class="headerlink" title="$  Euler $  变换"></a>$  Euler $  变换</h3><p>对于有标号的拼接<br>显然是做 $  \exp $<br>而对于无标号的拼接<br>例如生成函数为 $  f $<br>那么无标号拼接即为</p>
<script type="math/tex; mode=display">\xi(f(x))=\prod_{k=1}^{\infty}(\sum_{i=0}^{\infty}x^{ik})^{f_k}</script><p>组合意义显然<br>稍加推导</p>
<script type="math/tex; mode=display">=\prod_k(\frac{1}{1-x^k})^{f_k}\\
=\exp(\sum_{k}f_k\ln(\frac {1}{1-x^k}))\\
=\exp(\sum_kf_k\sum_{i=1}^{\infty}\frac{x^{ik}}{i})\\
=\exp(\sum_{i=1}^{\infty}\frac{f(x^i)}{i})</script><p>也可以考虑用 $  burnside $  证明<br><img src="https://img-blog.csdnimg.cn/20200320183348900.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyNTU1MDA5,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p>在生成函数计数中如果要牛顿迭代解方程 $  f_0\mod x^n\rightarrow f\mod x^{2n} $<br>如果里面有这个东西<br>可以发现 $  \xi(f)’=\xi(f) $<br>因为对于 $  i\geq2,f(x^i) $  在 $  \mod x^{2n} $  内是完全已知的<br>那么 $  \xi(f)’=\exp(f+g)’=\exp(f+g)=\xi(f) $  </p>
<hr>
<h3 id="多项式多点求值"><a href="#多项式多点求值" class="headerlink" title="多项式多点求值"></a>多项式多点求值</h3><p>已知一个 $  n $  次多项式 $  f(x) $  ，求 $  f(a_1)……f(a_m) $  </p>
<h4 id="求解过程-5"><a href="#求解过程-5" class="headerlink" title="求解过程"></a>求解过程</h4><p>考虑构造函数 $  P(x)=\prod_{i=1}^{m}(x-a_i) $<br>显然 $  \forall i\in[1,m],P(a_i)=0 $  </p>
<p>假设 $  f(x)=P(x)g(x)+A(x) $<br> $  A(x)=f(x)\%P(x) $  </p>
<p>那显然 $  f(a_i)=A(a_i) $<br>但由于 $  P(x) $  是 $  m $  次的，没有起到优化的作用</p>
<p>而考虑对于 $  k，P(x)=(x-a_k) $<br>则 $  f(x)\% P(x) $  后就只剩下一个常数项，即 $  f(a_i) $  的值了<br>但是这样一次就 $  nlogn $  了</p>
<p>考虑分治优化<br> $  P_1(x)=\prod_{i=l}^{mid}(x-a_i),P_2(x)=\prod_{i=mid+1}^{r}(x-a_i) $<br> $  \forall i\in[l,mid] ， f(x)\%P_1(x)=f(a_i) $<br>取模之后 $  f(x) $  的次数减少了一半，继续递归求解即可</p>
<p> $  P(x) $  可以先分治 $  ntt $  预处理出来<br>复杂度 $  T(n)=2*T(\frac n 2)+O(nlogn)=O(nlog^2n) $  </p>
<h4 id="代码实现-8"><a href="#代码实现-8" class="headerlink" title="代码实现"></a>代码实现</h4><p>第一次写 $  T $  掉了，预处理了一波单位根就跑过去了<br>也可以在比较小的时候暴力秦九韶展开，然并没写</p>
<h2 id="-2"><a href="#-2" class="headerlink" title=""></a><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">poly f[N&lt;&lt;<span class="number">2</span>];</span><br><span class="line"><span class="type">int</span> a[N];</span><br><span class="line"><span class="type">int</span> n,m;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> lc (u&lt;&lt;1)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> rc ((u&lt;&lt;1)|1)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mid ((l+r)&gt;&gt;1)</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> u,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> *v)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(l==r)&#123;f[u].<span class="built_in">pb</span>(<span class="built_in">dec</span>(<span class="number">0</span>,v[l])),f[u].<span class="built_in">pb</span>(<span class="number">1</span>);<span class="keyword">return</span>;&#125;</span><br><span class="line">	<span class="built_in">build</span>(lc,l,mid,v),<span class="built_in">build</span>(rc,mid<span class="number">+1</span>,r,v);</span><br><span class="line">	f[u]=f[lc]*f[rc];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">calc</span><span class="params">(<span class="type">int</span> u,<span class="type">int</span> l,<span class="type">int</span> r,poly now,<span class="type">int</span> *v)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(l==r)&#123;v[l]=now[<span class="number">0</span>];<span class="keyword">return</span>;&#125;</span><br><span class="line">	<span class="built_in">calc</span>(lc,l,mid,now%f[lc],v),<span class="built_in">calc</span>(rc,mid<span class="number">+1</span>,r,now%f[rc],v);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="keyword">undef</span> lc</span></span><br><span class="line"><span class="meta">#<span class="keyword">undef</span> rc</span></span><br><span class="line"><span class="meta">#<span class="keyword">undef</span> mid</span></span><br></pre></td></tr></table></figure></h2><h3 id="多项式快速插值"><a href="#多项式快速插值" class="headerlink" title="多项式快速插值"></a>多项式快速插值</h3><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_42555009/article/details/98348066">写在这里了</a></p>
<hr>
<h3 id="下降幂多项式乘法"><a href="#下降幂多项式乘法" class="headerlink" title="下降幂多项式乘法"></a>下降幂多项式乘法</h3><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_42555009/article/details/98317759">写在这里了</a></p>
<hr>
<h3 id="其他技巧"><a href="#其他技巧" class="headerlink" title="其他技巧"></a>其他技巧</h3><h4 id="多项式快速幂"><a href="#多项式快速幂" class="headerlink" title="多项式快速幂"></a>多项式快速幂</h4><p>直接快速幂要多个 $  log $  而且常数大（虽然 $  ln $  和 $  exp $  常数一样大死个仙人）<br>当 $  A[0]=1 $  时（ $  Ln $  要求保证这个）， <script type="math/tex">A(x)^k=Exp(ln(A(x))*k)</script><br>洛谷板子读入时取模<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> poly <span class="title">ksm</span><span class="params">(poly a,<span class="type">int</span> deg,<span class="type">int</span> k)</span></span>&#123;</span><br><span class="line">	a=<span class="built_in">exp</span>(<span class="built_in">Ln</span>(a,deg)*k,deg),a.<span class="built_in">resize</span>(deg);</span><br><span class="line">	<span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>对于 $  A[0]\not=1 $  也可以很简单的做<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_42555009/article/details/99657487">写在这里了</a></p>
<h4 id="MTT"><a href="#MTT" class="headerlink" title="$  MTT $"></a>$  MTT $</h4><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_42555009/article/details/102980922">写在这里了</a></p>
<h4 id="拉格朗日反演"><a href="#拉格朗日反演" class="headerlink" title="拉格朗日反演"></a>拉格朗日反演</h4><p>拉格朗日反演:<br>若 <script type="math/tex">f(g(x))=x</script><br>则 <script type="math/tex">g(f(x))=x，且[x^n]f(x)=\frac 1 n[x^{n-1}](\frac{x}{g(x)})^n</script><br>拓展拉格朗日反演<br>有 <script type="math/tex">[x^n]H(f(x))=\frac 1n [x^{n-1}]H'(x)(\frac{x}{g(x)})^n</script>  </p>
<h3 id="模板合集"><a href="#模板合集" class="headerlink" title="模板合集"></a>模板合集</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> C=<span class="number">20</span>,M=(<span class="number">1</span>&lt;&lt;C)<span class="number">+7</span>;</span><br><span class="line"><span class="type">int</span> *w[C<span class="number">+1</span>];</span><br><span class="line"><span class="type">int</span> rev[M],fac[M],ifac[M],inv[M];</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> poly vector<span class="string">&lt;int&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">init_rev</span><span class="params">(<span class="type">int</span> lim)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;lim;i++)rev[i]=(rev[i&gt;&gt;<span class="number">1</span>]&gt;&gt;<span class="number">1</span>)|((i&amp;<span class="number">1</span>)*(lim&gt;&gt;<span class="number">1</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">init_w</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=C;i++)</span><br><span class="line">	w[i]=<span class="keyword">new</span> <span class="type">int</span>[<span class="number">1</span>&lt;&lt;(i<span class="number">-1</span>)];</span><br><span class="line">	<span class="type">int</span> wn=<span class="built_in">ksm</span>(<span class="number">3</span>,(mod<span class="number">-1</span>)/(<span class="number">1</span>&lt;&lt;C));</span><br><span class="line">	w[C][<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;(<span class="number">1</span>&lt;&lt;(C<span class="number">-1</span>));i++)w[C][i]=<span class="built_in">mul</span>(w[C][i<span class="number">-1</span>],wn);</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=C<span class="number">-1</span>;i;i--)</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;(<span class="number">1</span>&lt;&lt;(i<span class="number">-1</span>));j++)</span><br><span class="line">	w[i][j]=w[i<span class="number">+1</span>][j&lt;&lt;<span class="number">1</span>];</span><br><span class="line">    fac[<span class="number">0</span>]=ifac[<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;M;i++)fac[i]=<span class="built_in">mul</span>(fac[i<span class="number">-1</span>],i);</span><br><span class="line">    ifac[M<span class="number">-1</span>]=<span class="built_in">Inv</span>(fac[M<span class="number">-1</span>]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=M<span class="number">-2</span>;i;i--)ifac[i]=<span class="built_in">mul</span>(ifac[i<span class="number">+1</span>],i<span class="number">+1</span>);</span><br><span class="line">    inv[<span class="number">0</span>]=inv[<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;M;i++)inv[i]=<span class="built_in">mul</span>(mod-mod/i,inv[mod%i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">ntt</span><span class="params">(poly &amp;f,<span class="type">int</span> lim,<span class="type">int</span> kd)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;lim;i++)<span class="keyword">if</span>(i&gt;rev[i])<span class="built_in">swap</span>(f[i],f[rev[i]]);</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> mid=<span class="number">1</span>,l=<span class="number">1</span>;mid&lt;lim;mid&lt;&lt;=<span class="number">1</span>,l++)</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;lim;i+=(mid&lt;&lt;<span class="number">1</span>))</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>,a0,a1;j&lt;mid;j++)</span><br><span class="line">			a0=f[i+j],a1=<span class="built_in">mul</span>(f[i+j+mid],w[l][j]),</span><br><span class="line">			f[i+j]=<span class="built_in">add</span>(a0,a1),f[i+j+mid]=<span class="built_in">dec</span>(a0,a1);</span><br><span class="line">	<span class="keyword">if</span>(kd==<span class="number">-1</span>&amp;&amp;(<span class="built_in">reverse</span>(f.<span class="built_in">bg</span>()<span class="number">+1</span>,f.<span class="built_in">bg</span>()+lim),<span class="number">1</span>))</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> inv=<span class="built_in">ksm</span>(lim,mod<span class="number">-2</span>),i=<span class="number">0</span>;i&lt;lim;i++)<span class="built_in">Mul</span>(f[i],inv);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">inline</span> poly <span class="keyword">operator</span> *(poly a,poly b)&#123;</span><br><span class="line">	<span class="type">int</span> deg=a.<span class="built_in">size</span>()+b.<span class="built_in">size</span>()<span class="number">-1</span>,lim=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">if</span>(a.<span class="built_in">size</span>()&lt;=<span class="number">32</span>||b.<span class="built_in">size</span>()&lt;=<span class="number">32</span>)&#123;</span><br><span class="line">		<span class="function">poly <span class="title">c</span><span class="params">(deg,<span class="number">0</span>)</span></span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;a.<span class="built_in">size</span>();i++)</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;b.<span class="built_in">size</span>();j++)</span><br><span class="line">			<span class="built_in">Add</span>(c[i+j],<span class="built_in">mul</span>(a[i],b[j]));</span><br><span class="line">		<span class="keyword">return</span> c;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">while</span>(lim&lt;deg)lim&lt;&lt;=<span class="number">1</span>;<span class="built_in">init_rev</span>(lim);</span><br><span class="line">	a.<span class="built_in">resize</span>(lim),<span class="built_in">ntt</span>(a,lim,<span class="number">1</span>);</span><br><span class="line">	b.<span class="built_in">resize</span>(lim),<span class="built_in">ntt</span>(b,lim,<span class="number">1</span>);</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;lim;i++)<span class="built_in">Mul</span>(a[i],b[i]);</span><br><span class="line">	<span class="built_in">ntt</span>(a,lim,<span class="number">-1</span>),a.<span class="built_in">resize</span>(deg);</span><br><span class="line">	<span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> poly <span class="title">Inv</span><span class="params">(poly a,<span class="type">int</span> deg)</span></span>&#123;</span><br><span class="line">	poly c,<span class="built_in">b</span>(<span class="number">1</span>,<span class="built_in">ksm</span>(a[<span class="number">0</span>],mod<span class="number">-2</span>));</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> lim=<span class="number">4</span>;lim&lt;(deg&lt;&lt;<span class="number">2</span>);lim&lt;&lt;=<span class="number">1</span>)&#123;</span><br><span class="line">		<span class="built_in">init_rev</span>(lim);</span><br><span class="line">		c=a,c.<span class="built_in">resize</span>(lim&gt;&gt;<span class="number">1</span>);</span><br><span class="line">		c.<span class="built_in">resize</span>(lim),<span class="built_in">ntt</span>(c,lim,<span class="number">1</span>);</span><br><span class="line">		b.<span class="built_in">resize</span>(lim),<span class="built_in">ntt</span>(b,lim,<span class="number">1</span>);</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;lim;i++)<span class="built_in">Mul</span>(b[i],<span class="built_in">dec</span>(<span class="number">2</span>,<span class="built_in">mul</span>(b[i],c[i])));</span><br><span class="line">		<span class="built_in">ntt</span>(b,lim,<span class="number">-1</span>),b.<span class="built_in">resize</span>(lim&gt;&gt;<span class="number">1</span>);</span><br><span class="line">	&#125;b.<span class="built_in">resize</span>(deg);<span class="keyword">return</span> b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> poly <span class="title">Sqrt</span><span class="params">(poly a,<span class="type">int</span> deg)</span></span>&#123;</span><br><span class="line">	<span class="function">poly <span class="title">b</span><span class="params">(<span class="number">1</span>,<span class="number">1</span>)</span>,c,d</span>;<span class="type">int</span> inv2=<span class="built_in">ksm</span>(<span class="number">2</span>,mod<span class="number">-2</span>);</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> lim=<span class="number">4</span>;lim&lt;(deg&lt;&lt;<span class="number">2</span>);lim&lt;&lt;=<span class="number">1</span>)&#123;</span><br><span class="line">		c=a,c.<span class="built_in">resize</span>(lim&gt;&gt;<span class="number">1</span>);</span><br><span class="line">		<span class="built_in">init_rev</span>(lim),d=<span class="built_in">Inv</span>(b,lim&gt;&gt;<span class="number">1</span>),</span><br><span class="line">		c=c*d,b.<span class="built_in">resize</span>(lim);</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;lim;i++)b[i]=<span class="built_in">mul</span>(inv2,<span class="built_in">add</span>(b[i],c[i]));</span><br><span class="line">	&#125;b.<span class="built_in">resize</span>(deg);<span class="keyword">return</span> b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">inline</span> poly <span class="keyword">operator</span> /(poly a,poly b)&#123;</span><br><span class="line">	<span class="type">int</span> lim=<span class="number">1</span>,deg=a.<span class="built_in">size</span>()-b.<span class="built_in">size</span>()<span class="number">+1</span>;</span><br><span class="line">	<span class="built_in">reverse</span>(a.<span class="built_in">bg</span>(),a.<span class="built_in">end</span>());</span><br><span class="line">	<span class="built_in">reverse</span>(b.<span class="built_in">bg</span>(),b.<span class="built_in">end</span>());</span><br><span class="line">	<span class="keyword">while</span>(lim&lt;=deg)lim&lt;&lt;=<span class="number">1</span>;</span><br><span class="line">	b=<span class="built_in">Inv</span>(b,lim),b.<span class="built_in">resize</span>(deg);</span><br><span class="line">	a=a*b,a.<span class="built_in">resize</span>(deg);</span><br><span class="line">	<span class="built_in">reverse</span>(a.<span class="built_in">bg</span>(),a.<span class="built_in">end</span>());</span><br><span class="line">	<span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">inline</span> poly <span class="keyword">operator</span> %(poly a,poly b)&#123;</span><br><span class="line">	poly c=a-(a/b)*b;</span><br><span class="line">	c.<span class="built_in">resize</span>(b.<span class="built_in">size</span>()<span class="number">-1</span>);</span><br><span class="line">	<span class="keyword">return</span> c;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> poly <span class="title">deriv</span><span class="params">(poly a)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;a.<span class="built_in">size</span>()<span class="number">-1</span>;i++)a[i]=<span class="built_in">mul</span>(a[i<span class="number">+1</span>],i<span class="number">+1</span>);</span><br><span class="line">	a.<span class="built_in">pob</span>();<span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> poly <span class="title">integ</span><span class="params">(poly a)</span></span>&#123;</span><br><span class="line">	a.<span class="built_in">pb</span>(<span class="number">0</span>);</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=a.<span class="built_in">size</span>()<span class="number">-1</span>;i;i--)a[i]=<span class="built_in">mul</span>(a[i<span class="number">-1</span>],inv[i]);</span><br><span class="line">	a[<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> poly <span class="title">Ln</span><span class="params">(poly a,<span class="type">int</span> lim)</span></span>&#123;</span><br><span class="line">	a=<span class="built_in">integ</span>(<span class="built_in">deriv</span>(a)*<span class="built_in">Inv</span>(a,lim)),a.<span class="built_in">resize</span>(lim);</span><br><span class="line">	<span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> poly <span class="title">exp</span><span class="params">(poly a,<span class="type">int</span> deg)</span></span>&#123;</span><br><span class="line">	<span class="function">poly <span class="title">b</span><span class="params">(<span class="number">1</span>,<span class="number">1</span>)</span>,c</span>;<span class="type">int</span> n=a.<span class="built_in">size</span>();</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> lim=<span class="number">2</span>;lim&lt;(deg&lt;&lt;<span class="number">1</span>);lim&lt;&lt;=<span class="number">1</span>)&#123;</span><br><span class="line">		c=<span class="built_in">Ln</span>(b,lim);</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;lim;i++)c[i]=<span class="built_in">dec</span>(i&lt;n?a[i]:<span class="number">0</span>,c[i]);</span><br><span class="line">		<span class="built_in">Add</span>(c[<span class="number">0</span>],<span class="number">1</span>),b=b*c;</span><br><span class="line">		b.<span class="built_in">resize</span>(lim);</span><br><span class="line">	&#125;b.<span class="built_in">resize</span>(deg);<span class="keyword">return</span> b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> poly <span class="title">ksm</span><span class="params">(poly a,<span class="type">int</span> deg,<span class="type">int</span> k)</span></span>&#123;</span><br><span class="line">	a=<span class="built_in">exp</span>(<span class="built_in">Ln</span>(a,deg)*k,deg),a.<span class="built_in">resize</span>(deg);</span><br><span class="line">	<span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br><span class="line">poly f[N&lt;&lt;<span class="number">2</span>];</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mid ((l+r)&gt;&gt;1)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> lc (u&lt;&lt;1)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> rc ((u&lt;&lt;1)|1)</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> u,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> *a)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(l==r)&#123;</span><br><span class="line">		f[u].<span class="built_in">clear</span>();</span><br><span class="line">		f[u].<span class="built_in">pb</span>(<span class="built_in">dec</span>(<span class="number">0</span>,a[l]));</span><br><span class="line">		f[u].<span class="built_in">pb</span>(<span class="number">1</span>);<span class="keyword">return</span>;</span><br><span class="line">	&#125;<span class="built_in">build</span>(lc,l,mid,a),<span class="built_in">build</span>(rc,mid<span class="number">+1</span>,r,a);</span><br><span class="line">	f[u]=f[lc]*f[rc];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">calc</span><span class="params">(<span class="type">int</span> u,<span class="type">int</span> l,<span class="type">int</span> r,poly g,<span class="type">int</span> *a)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(l==r)&#123;a[l]=g[<span class="number">0</span>];<span class="keyword">return</span>;&#125;</span><br><span class="line">	<span class="built_in">calc</span>(lc,l,mid,g%f[lc],a);</span><br><span class="line">	<span class="built_in">calc</span>(rc,mid<span class="number">+1</span>,r,g%f[rc],a);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">getans</span><span class="params">(poly a,<span class="type">int</span> *b,<span class="type">int</span> num)</span></span>&#123;</span><br><span class="line">	<span class="built_in">build</span>(<span class="number">1</span>,<span class="number">1</span>,num,b),<span class="built_in">calc</span>(<span class="number">1</span>,<span class="number">1</span>,num,a,b);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="keyword">undef</span> mid</span></span><br><span class="line"><span class="meta">#<span class="keyword">undef</span> lc</span></span><br><span class="line"><span class="meta">#<span class="keyword">undef</span> rc</span></span><br></pre></td></tr></table></figure>
    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/XCPC-Templates/" rel="tag"># XCPC,Templates</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2024/09/08/my-notes/" rel="prev" title="my notes">
      <i class="fa fa-chevron-left"></i> my notes
    </a></div>
      <div class="post-nav-item">
    <a href="/2024/09/16/%E7%94%9F%E6%88%90%E5%87%BD%E6%95%B0%E4%B8%AD%E6%9F%90%E4%BA%9B%E8%AE%A1%E6%95%B0%E9%97%AE%E9%A2%98/" rel="next" title="生成函数中某些计数问题">
      生成函数中某些计数问题 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E5%8A%A0%E5%87%8F%E7%82%B9%E4%B9%98%E7%82%B9%E9%99%A4"><span class="nav-number">1.</span> <span class="nav-text">多项式加减点乘点除</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E4%B9%98%E6%B3%95"><span class="nav-number">2.</span> <span class="nav-text">多项式乘法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#FFT%EF%BC%9A"><span class="nav-number">3.</span> <span class="nav-text">FFT：</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%89%8D%E7%BD%AE"><span class="nav-number">3.1.</span> <span class="nav-text">前置</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%AE%97%E6%B3%95"><span class="nav-number">3.2.</span> <span class="nav-text">算法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0"><span class="nav-number">3.3.</span> <span class="nav-text">代码实现</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#NTT%EF%BC%9A"><span class="nav-number">4.</span> <span class="nav-text">NTT：</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0-1"><span class="nav-number">4.1.</span> <span class="nav-text">代码实现</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E6%B1%82%E9%80%86%EF%BC%9A"><span class="nav-number">5.</span> <span class="nav-text">多项式求逆：</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%B1%82%E8%A7%A3%E8%BF%87%E7%A8%8B"><span class="nav-number">5.1.</span> <span class="nav-text">求解过程</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0-2"><span class="nav-number">5.2.</span> <span class="nav-text">代码实现</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link"><span class="nav-number"></span> <span class="nav-text">1234567891011inline poly Inv(poly a,int deg){	poly c,b(1,ksm(a[0],mod-2));	for(int lim&#x3D;4;lim&lt;(deg&lt;&lt;2);lim&lt;&lt;&#x3D;1){		init(lim);		c&#x3D;a,c.resize(lim&gt;&gt;1);		c.resize(lim),ntt(c,lim,1);		b.resize(lim),ntt(b,lim,1);		for(int i&#x3D;0;i&lt;lim;i++)Mul(b[i],dec(2,mul(b[i],c[i])));		ntt(b,lim,-1),b.resize(lim&gt;&gt;1);	}b.resize(deg);return b;}</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E5%BC%80%E6%96%B9%EF%BC%9A"><span class="nav-number">1.</span> <span class="nav-text">多项式开方：</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%B1%82%E8%A7%A3%E8%BF%87%E7%A8%8B-1"><span class="nav-number">1.1.</span> <span class="nav-text">求解过程</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0-3"><span class="nav-number">1.2.</span> <span class="nav-text">代码实现</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E9%99%A4%E6%B3%95%E5%92%8C%E5%8F%96%E6%A8%A1%EF%BC%9A"><span class="nav-number">2.</span> <span class="nav-text">多项式除法和取模：</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%B1%82%E8%A7%A3%E8%BF%87%E7%A8%8B-2"><span class="nav-number">2.1.</span> <span class="nav-text">求解过程</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0-4"><span class="nav-number">2.2.</span> <span class="nav-text">代码实现</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E6%B1%82%E5%AF%BC%E4%B8%8E%E7%A7%AF%E5%88%86"><span class="nav-number">3.</span> <span class="nav-text">多项式求导与积分</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0-5"><span class="nav-number">3.1.</span> <span class="nav-text">代码实现</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8FLn"><span class="nav-number">4.</span> <span class="nav-text">多项式Ln</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%B1%82%E8%A7%A3%E8%BF%87%E7%A8%8B-3"><span class="nav-number">4.1.</span> <span class="nav-text">求解过程</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0-6"><span class="nav-number">4.2.</span> <span class="nav-text">代码实现</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#-1"><span class="nav-number"></span> <span class="nav-text">12345678&#x2F;*if f(x)&#x3D;Ln(g(x))then g&#39;(x)&#x3D;f&#39;(x)g(x)*&#x2F;inline poly Ln(poly a,int lim){	a&#x3D;integ(deriv(a)*Inv(a,lim)),a.resize(lim);	return a;}</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8FExp"><span class="nav-number">1.</span> <span class="nav-text">多项式Exp</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%89%8D%E7%BD%AE%E7%9F%A5%E8%AF%86"><span class="nav-number">1.1.</span> <span class="nav-text">前置知识</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%B3%B0%E5%8B%92%E5%B1%95%E5%BC%80"><span class="nav-number">1.1.1.</span> <span class="nav-text">泰勒展开</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%89%9B%E9%A1%BF%E8%BF%AD%E4%BB%A3"><span class="nav-number">1.1.2.</span> <span class="nav-text">牛顿迭代</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%B1%82%E8%A7%A3%E8%BF%87%E7%A8%8B-4"><span class="nav-number">1.2.</span> <span class="nav-text">求解过程</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0-7"><span class="nav-number">1.3.</span> <span class="nav-text">代码实现</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Euler-%E5%8F%98%E6%8D%A2"><span class="nav-number">2.</span> <span class="nav-text">$  Euler $  变换</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E5%A4%9A%E7%82%B9%E6%B1%82%E5%80%BC"><span class="nav-number">3.</span> <span class="nav-text">多项式多点求值</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%B1%82%E8%A7%A3%E8%BF%87%E7%A8%8B-5"><span class="nav-number">3.1.</span> <span class="nav-text">求解过程</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0-8"><span class="nav-number">3.2.</span> <span class="nav-text">代码实现</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#-2"><span class="nav-number"></span> <span class="nav-text">123456789101112131415161718poly f[N&lt;&lt;2];int a[N];int n,m;#define lc (u&lt;&lt;1)#define rc ((u&lt;&lt;1)|1)#define mid ((l+r)&gt;&gt;1)void build(int u,int l,int r,int *v){	if(l&#x3D;&#x3D;r){f[u].pb(dec(0,v[l])),f[u].pb(1);return;}	build(lc,l,mid,v),build(rc,mid+1,r,v);	f[u]&#x3D;f[lc]*f[rc];}void calc(int u,int l,int r,poly now,int *v){	if(l&#x3D;&#x3D;r){v[l]&#x3D;now[0];return;}	calc(lc,l,mid,now%f[lc],v),calc(rc,mid+1,r,now%f[rc],v);}#undef lc#undef rc#undef mid</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E5%BF%AB%E9%80%9F%E6%8F%92%E5%80%BC"><span class="nav-number">1.</span> <span class="nav-text">多项式快速插值</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%8B%E9%99%8D%E5%B9%82%E5%A4%9A%E9%A1%B9%E5%BC%8F%E4%B9%98%E6%B3%95"><span class="nav-number">2.</span> <span class="nav-text">下降幂多项式乘法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%B6%E4%BB%96%E6%8A%80%E5%B7%A7"><span class="nav-number">3.</span> <span class="nav-text">其他技巧</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E5%BF%AB%E9%80%9F%E5%B9%82"><span class="nav-number">3.1.</span> <span class="nav-text">多项式快速幂</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#MTT"><span class="nav-number">3.2.</span> <span class="nav-text">$  MTT $</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8B%89%E6%A0%BC%E6%9C%97%E6%97%A5%E5%8F%8D%E6%BC%94"><span class="nav-number">3.3.</span> <span class="nav-text">拉格朗日反演</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A8%A1%E6%9D%BF%E5%90%88%E9%9B%86"><span class="nav-number">4.</span> <span class="nav-text">模板合集</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Yike Chen</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">6</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">tags</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Yike Chen</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://mist.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
          load: ['[tex]/mhchem'],
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
          packages: {'[+]': ['mhchem']},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

</body>
</html>
